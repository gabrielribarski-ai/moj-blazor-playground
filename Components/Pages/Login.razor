@page "/"
@using IzracunInvalidnostiBlazor.Models
@using IzracunInvalidnostiBlazor.Services
@inject NavigationManager Nav
@inject UserSessionStorageService SessionService
@inject IConfiguration _config
@inject LoaderService Loader
@code {
    protected override async Task OnInitializedAsync()
    {
        // Preberi query string
        var uri = Nav.ToAbsoluteUri(Nav.Uri);
        var query = System.Web.HttpUtility.ParseQueryString(uri.Query);

        var user = new PrijavljenUporabnik
        {
            UpIme = query["username"] ?? "NovakJ",
            Ime = query["ime"] ?? "Janez",
            Priimek = query["priimek"] ?? "Novak",
            CasPrijave = DateTime.Now,
            StDokumenta="D-3221342354",
            ImePacienta =  "Maja",
            PriimekPacienta =  "Demšar",
            OcenjevalniModel = new OcenjevalniModel()
            {
                // Lahko dodaš še inicializacijo, če želiš
            }
        };
        await SessionService.SaveUserAsync(user);

        // Preusmeri na glavno stran
        Nav.NavigateTo("/");
    }
}
